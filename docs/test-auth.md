# 身份驗證功能測試

## 測試資料（第一筆）

- **股東代號**: `012345`
- **身分證字號**: `J012345678`
- **身分證末四碼**: `5678`
- **UUID**: `C895AA67-A2BB-4C44-8113-88A8738C434A`
- **姓名**: `許雅雯`

## 測試步驟

### 測試 1: 輸入正確的身分證末四碼

1. **開啟測試 URL**:
   ```
   http://localhost:6230/shareholder/update/C895AA67-A2BB-4C44-8113-88A8738C434A
   ```

2. **操作步驟**:
   - 等待身份驗證彈窗顯示
   - 在 4 個輸入框中依序輸入：`5` `6` `7` `8`
   - 輸入滿 4 碼後，系統會自動發送驗證（無需按確認鍵）

3. **預期結果**:
   - ✅ 顯示身份驗證彈窗（標題：「中華工程股份有限公司股東資料回報」）
   - ✅ 輸入 `5678`（身分證末四碼）
   - ✅ 輸入滿 4 碼後自動發送驗證（無需按確認鍵）
   - ✅ 驗證成功後直接進入個人資料頁面（不顯示錯誤訊息）
   - ✅ 顯示股東資料（姓名：許雅雯）
   - ✅ 顯示「股東資料更新」標題

### 測試 2: 輸入錯誤的身分證末四碼

1. **開啟測試 URL**:
   ```
   http://localhost:6230/shareholder/update/C895AA67-A2BB-4C44-8113-88A8738C434A
   ```

2. **操作步驟**:
   - 等待身份驗證彈窗顯示
   - 在 4 個輸入框中依序輸入錯誤的末四碼（例如：`1` `2` `3` `4`）
   - 輸入滿 4 碼後，系統會自動發送驗證

3. **預期結果**:
   - ✅ 顯示身份驗證彈窗
   - ✅ 輸入錯誤的末四碼（例如：`1234`）
   - ✅ 輸入滿 4 碼後自動發送驗證
   - ✅ **輸入框彈跳動畫**提示錯誤（約 0.4 秒）
   - ✅ **輸入內容被清空**（四個輸入框都變為空白）
   - ✅ **自動聚焦到第一個輸入框**（可直接輸入，無需點擊）
   - ✅ **在下方顯示錯誤訊息**（Alert 組件）：
     - **主要錯誤訊息**（顯著顯示，粗體）：「認證失敗，請重新輸入身分證末四碼」
     - **補充說明**：「請確認已掃描信件上的 QR Code，並輸入您的身分證末四碼」
     - **聯絡資訊**：「」
   - ✅ 可以立即重新輸入（無需點擊輸入框）

## 文檔規範對照

根據 `specs/001-shareholder-data-update/spec.md`:

### Acceptance Scenario 2 (正確輸入)
- ✅ 輸入正確的身分證末四碼（數字）且輸入完成（填滿 4 碼）
- ✅ 系統自動發送驗證並載入該股東的個人資料，無需按確認鍵

### Acceptance Scenario 3-5 (錯誤輸入)
- ✅ 輸入格式錯誤或與 QR Code 不符
- ✅ 系統在彈窗內顯示統一錯誤訊息
- ✅ 輸入框彈跳動畫提示錯誤
- ✅ 清空輸入內容
- ✅ 自動聚焦，可直接重新輸入

### FR-009 (錯誤處理規範)
- ✅ 統一錯誤訊息格式（主要錯誤、補充說明、聯絡資訊）
- ✅ 錯誤時觸發輸入框彈跳動畫並清空輸入
- ✅ 允許無限次重試

## 測試檢查清單

### 測試 1: 正確輸入
- [ ] 開啟 URL 後顯示身份驗證彈窗
- [ ] 輸入正確的末四碼 `5678`
- [ ] 輸入滿 4 碼後自動發送驗證（無需按確認鍵）
- [ ] 驗證成功後直接進入個人資料頁面
- [ ] 顯示股東資料（姓名：許雅雯）

### 測試 2: 錯誤輸入
- [ ] 開啟 URL 後顯示身份驗證彈窗
- [ ] 輸入錯誤的末四碼（例如：`1234`）
- [ ] 輸入滿 4 碼後自動發送驗證
- [ ] 輸入框彈跳動畫（約 0.4 秒）
- [ ] 輸入內容被清空
- [ ] 自動聚焦到第一個輸入框（可直接輸入）
- [ ] 在下方顯示錯誤訊息（三層結構）
- [ ] 可以立即重新輸入（無需點擊）

## 注意事項

1. 確保開發伺服器正在運行：`npm run dev`
2. 確保資料庫連接正常
3. 測試時請使用第一筆資料的 UUID：`C895AA67-A2BB-4C44-8113-88A8738C434A`
4. 正確的身分證末四碼：`5678`
5. 錯誤的身分證末四碼：可使用任何其他 4 位數字（例如：`1234`、`0000` 等）

